---
import Layout from './base-layout.astro'
import Article from '../components/article.astro'
import { title as blogTitle } from '../consts/config'

const { content } = Astro.props
const { title, cover, id } = content

const permalink = `/p/${id}`
const isPermalink = `${Astro.url}`.indexOf(`${Astro.site.pathname}p/`) > -1
const Component = isPermalink ? Layout : Fragment
---

<Component
  title={`${blogTitle} - ${title}`}
  description={Astro.props.rawContent().split('\n')[0]}
  {cover}
  {permalink}
>
  <Article {...content} url={permalink}>
    <Fragment set:html={Astro.props.compiledContent()} />
  </Article>
</Component>
